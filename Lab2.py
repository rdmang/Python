# -*- coding: utf-8 -*-
import numpy as np
import pandas as pd
import random as random

df = pd.read_csv("E:\\Smarket.csv")

print("\n До преобразования\n")
print(df)

# Значения столбца Lag1
class_mapping = {label: idx for idx, label in enumerate(np.unique(df['Lag1']))}
df['Lag1'] = df['Lag1'].map(class_mapping)

print("\n После преоразования\n")
print(df)

# Инвертация
inv_class_mapping = {v: k for k, v in class_mapping.items()}
df['Lag1'] = df['Lag1'].map(inv_class_mapping)

# Присвоение NaN
for idx in range(0, df['Lag1'].values.size):
    prob = random.uniform(0.0, 1.0)
    if prob > 0.783220:
        df.loc[idx, 'Lag1'] = np.NaN

for idx in range(0, df['Lag1'].values.size):
    prob = random.uniform(0.0, 1.0)
    if prob > 0.783221:
        df.loc[idx, 'Lag3'] = np.NaN

for idx in range(0, df['Lag1'].values.size):
    prob = random.uniform(0.0, 1.0)
    if prob > 0.583914:
        df.loc[idx, 'Lag4'] = np.NaN

print("\n C NaN: \n")
print(df)

print("\n Количество NaN: \n")
print(pd.isnull(df).sum())

print("\n Замена NaN: \n")
print(df.fillna(df.mean()))

#Output

'''        
    До преобразования:
        
        Unnamed: 0  Year  Lag1   Lag2   Lag3   Lag4   Lag5   Volume  Today  \
0              1  2001    0.381 -0.192 -2.624 -1.055  5.010  1.19130  0.959   
1              2  2001    0.959  0.381 -0.192 -2.624 -1.055  1.29650  1.032   
2              3  2001    1.032  0.959  0.381 -0.192 -2.624  1.41120 -0.623   
3              4  2001   -0.623  1.032  0.959  0.381 -0.192  1.27600  0.614   
4              5  2001    0.614 -0.623  1.032  0.959  0.381  1.20570  0.213   
5              6  2001    0.213  0.614 -0.623  1.032  0.959  1.34910  1.392   
6              7  2001    1.392  0.213  0.614 -0.623  1.032  1.44500 -0.403   
7              8  2001   -0.403  1.392  0.213  0.614 -0.623  1.40780  0.027   
8              9  2001    0.027 -0.403  1.392  0.213  0.614  1.16400  1.303   
9             10  2001    1.303  0.027 -0.403  1.392  0.213  1.23260  0.287   
10            11  2001    0.287  1.303  0.027 -0.403  1.392  1.30900 -0.498   
11            12  2001   -0.498  0.287  1.303  0.027 -0.403  1.25800 -0.189   
12            13  2001   -0.189 -0.498  0.287  1.303  0.027  1.09800  0.680   
13            14  2001    0.680 -0.189 -0.498  0.287  1.303  1.05310  0.701   
14            15  2001    0.701  0.680 -0.189 -0.498  0.287  1.14980 -0.562   
15            16  2001   -0.562  0.701  0.680 -0.189 -0.498  1.29530  0.546   
16            17  2001    0.546 -0.562  0.701  0.680 -0.189  1.11880 -1.747   
17            18  2001   -1.747  0.546 -0.562  0.701  0.680  1.04840  0.359   
18            19  2001   0 .359 -1.747  0.546 -0.562  0.701  1.01300 -0.151   
19            20  2001   -0.151  0.359 -1.747  0.546 -0.562  1.05960 -0.841   
20            21  2001   -0.841 -0.151  0.359 -1.747  0.546  1.15830 -0.623   
21            22  2001   -0.623 -0.841 -0.151  0.359 -1.747  1.10720 -1.334   
22            23  2001   -1.334 -0.623 -0.841 -0.151  0.359  1.07550  1.183   
23            24  2001    1.183 -1.334 -0.623 -0.841 -0.151  1.03910 -0.865   
24            25  2001   -0.865  1.183 -1.334 -0.623 -0.841  1.07520 -0.218   
25            26  2001   -0.218 -0.865  1.183 -1.334 -0.623  1.15030  0.812   
26            27  2001    0.812 -0.218 -0.865  1.183 -1.334  1.15370 -1.891   
27            28  2001   -1.891  0.812 -0.218 -0.865  1.183  1.25720 -1.736   
28            29  2001   -1.736 -1.891  0.812 -0.218 -0.865  1.11220 -1.851   
29            30  2001   -1.851 -1.736 -1.891  0.812 -0.218  1.20850 -0.195

    После преобразования:

      Unnamed: 0  Year  Lag1   Lag2   Lag3   Lag4   Lag5   Volume  Today  \
0              1  2001   669 -0.192 -2.624 -1.055  5.010  1.19130  0.959   
1              2  2001   855  0.381 -0.192 -2.624 -1.055  1.29650  1.032   
2              3  2001   877  0.959  0.381 -0.192 -2.624  1.41120 -0.623   
3              4  2001   282  1.032  0.959  0.381 -0.192  1.27600  0.614   
4              5  2001   758 -0.623  1.032  0.959  0.381  1.20570  0.213   
5              6  2001   598  0.614 -0.623  1.032  0.959  1.34910  1.392   
6              7  2001   937  0.213  0.614 -0.623  1.032  1.44500 -0.403   
7              8  2001   347  1.392  0.213  0.614 -0.623  1.40780  0.027   
8              9  2001   516 -0.403  1.392  0.213  0.614  1.16400  1.303   
9             10  2001   925  0.027 -0.403  1.392  0.213  1.23260  0.287   
10            11  2001   634  1.303  0.027 -0.403  1.392  1.30900 -0.498   
11            12  2001   320  0.287  1.303  0.027 -0.403  1.25800 -0.189   
12            13  2001   425 -0.498  0.287  1.303  0.027  1.09800  0.680   
13            14  2001   784 -0.189 -0.498  0.287  1.303  1.05310  0.701   
14            15  2001   793  0.680 -0.189 -0.498  0.287  1.14980 -0.562   
15            16  2001   300  0.701  0.680 -0.189 -0.498  1.29530  0.546   
16            17  2001   735 -0.562  0.701  0.680 -0.189  1.11880 -1.747   
17            18  2001    63  0.546 -0.562  0.701  0.680  1.04840  0.359   
18            19  2001   662 -1.747  0.546 -0.562  0.701  1.01300 -0.151   
19            20  2001   443  0.359 -1.747  0.546 -0.562  1.05960 -0.841   
20            21  2001   217 -0.151  0.359 -1.747  0.546  1.15830 -0.623   
21            22  2001   282 -0.841 -0.151  0.359 -1.747  1.10720 -1.334   
22            23  2001   128 -0.623 -0.841 -0.151  0.359  1.07550  1.183   
23            24  2001   903 -1.334 -0.623 -0.841 -0.151  1.03910 -0.865   
24            25  2001   209  1.183 -1.334 -0.623 -0.841  1.07520 -0.218   
25            26  2001   414 -0.865  1.183 -1.334 -0.623  1.15030  0.812   
26            27  2001   820 -0.218 -0.865  1.183 -1.334  1.15370 -1.891   
27            28  2001    51  0.812 -0.218 -0.865  1.183  1.25720 -1.736   
28            29  2001    64 -1.891  0.812 -0.218 -0.865  1.11220 -1.851   
29            30  2001    55 -1.736 -1.891  0.812 -0.218  1.20850 -0.195   

    С NaN: 

      Unnamed: 0  Year   Lag1   Lag2   Lag3   Lag4   Lag5   Volume  Today  \
0              1  2001  0.381 -0.192    NaN -1.055  5.010  1.19130  0.959   
1              2  2001  0.959  0.381 -0.192    NaN -1.055  1.29650  1.032   
2              3  2001  1.032  0.959  0.381 -0.192 -2.624  1.41120 -0.623   
3              4  2001    NaN  1.032  0.959    NaN -0.192  1.27600  0.614   
4              5  2001  0.614 -0.623  1.032  0.959  0.381  1.20570  0.213   
5              6  2001  0.213  0.614    NaN    NaN  0.959  1.34910  1.392   
6              7  2001  1.392  0.213  0.614    NaN  1.032  1.44500 -0.403   
7              8  2001 -0.403  1.392  0.213  0.614 -0.623  1.40780  0.027   
8              9  2001  0.027 -0.403  1.392    NaN  0.614  1.16400  1.303   
9             10  2001  1.303  0.027 -0.403    NaN  0.213  1.23260  0.287   
10            11  2001  0.287  1.303  0.027 -0.403  1.392  1.30900 -0.498   
11            12  2001    NaN  0.287  1.303    NaN -0.403  1.25800 -0.189   
12            13  2001    NaN -0.498  0.287    NaN  0.027  1.09800  0.680   
13            14  2001  0.680 -0.189 -0.498  0.287  1.303  1.05310  0.701   
14            15  2001  0.701  0.680    NaN -0.498  0.287  1.14980 -0.562   
15            16  2001 -0.562  0.701    NaN -0.189 -0.498  1.29530  0.546   
16            17  2001    NaN -0.562  0.701  0.680 -0.189  1.11880 -1.747   
17            18  2001 -1.747  0.546 -0.562    NaN  0.680  1.04840  0.359   
18            19  2001    NaN -1.747  0.546 -0.562  0.701  1.01300 -0.151   
19            20  2001    NaN  0.359 -1.747  0.546 -0.562  1.05960 -0.841   
20            21  2001 -0.841 -0.151    NaN -1.747  0.546  1.15830 -0.623   
21            22  2001 -0.623 -0.841 -0.151    NaN -1.747  1.10720 -1.334   
22            23  2001 -1.334 -0.623    NaN -0.151  0.359  1.07550  1.183   
23            24  2001    NaN -1.334 -0.623    NaN -0.151  1.03910 -0.865   
24            25  2001 -0.865  1.183    NaN    NaN -0.841  1.07520 -0.218   
25            26  2001    NaN -0.865  1.183    NaN -0.623  1.15030  0.812   
26            27  2001  0.812 -0.218 -0.865    NaN -1.334  1.15370 -1.891   
27            28  2001 -1.891  0.812 -0.218    NaN  1.183  1.25720 -1.736   
28            29  2001 -1.736 -1.891  0.812 -0.218 -0.865  1.11220 -1.851   
29            30  2001 -1.851 -1.736 -1.891    NaN -0.218  1.20850 -0.195  

    Количество NaN: 

Unnamed: 0      0
Year            0
Lag1            8
Lag2            0
Lag3            7
Lag4           16
Lag5            0
Volume          0
Today           0
Direction       0
dtype: int64      

    Замена NaN: 

      Unnamed: 0  Year      Lag1   Lag2      Lag3      Lag4   Lag5   Volume  \
0              1  2001  0.381000 -0.192 -0.018496 -1.055000  5.010  1.19130   
1              2  2001  0.959000  0.381 -0.192000  0.012874 -1.055  1.29650   
2              3  2001  1.032000  0.959  0.381000 -0.192000 -2.624  1.41120   
3              4  2001  0.025744  1.032  0.959000  0.012874 -0.192  1.27600   
4              5  2001  0.614000 -0.623  1.032000  0.959000  0.381  1.20570   
5              6  2001  0.213000  0.614 -0.018496  0.012874  0.959  1.34910   
6              7  2001  1.392000  0.213  0.614000  0.012874  1.032  1.44500   
7              8  2001 -0.403000  1.392  0.213000  0.614000 -0.623  1.40780   
8              9  2001  0.027000 -0.403  1.392000  0.012874  0.614  1.16400   
9             10  2001  1.303000  0.027 -0.403000  0.012874  0.213  1.23260   
10            11  2001  0.287000  1.303  0.027000 -0.403000  1.392  1.30900   
11            12  2001  0.025744  0.287  1.303000  0.012874 -0.403  1.25800   
12            13  2001  0.025744 -0.498  0.287000  0.012874  0.027  1.09800   
13            14  2001  0.680000 -0.189 -0.498000  0.287000  1.303  1.05310   
14            15  2001  0.701000  0.680 -0.018496 -0.498000  0.287  1.14980   
15            16  2001 -0.562000  0.701 -0.018496 -0.189000 -0.498  1.29530   
16            17  2001  0.025744 -0.562  0.701000  0.680000 -0.189  1.11880   
17            18  2001 -1.747000  0.546 -0.562000  0.012874  0.680  1.04840   
18            19  2001  0.025744 -1.747  0.546000 -0.562000  0.701  1.01300   
19            20  2001  0.025744  0.359 -1.747000  0.546000 -0.562  1.05960   
20            21  2001 -0.841000 -0.151 -0.018496 -1.747000  0.546  1.15830   
21            22  2001 -0.623000 -0.841 -0.151000  0.012874 -1.747  1.10720   
22            23  2001 -1.334000 -0.623 -0.018496 -0.151000  0.359  1.07550   
23            24  2001  0.025744 -1.334 -0.623000  0.012874 -0.151  1.03910   
24            25  2001 -0.865000  1.183 -0.018496  0.012874 -0.841  1.07520   
25            26  2001  0.025744 -0.865  1.183000  0.012874 -0.623  1.15030   
26            27  2001  0.812000 -0.218 -0.865000  0.012874 -1.334  1.15370   
27            28  2001 -1.891000  0.812 -0.218000  0.012874  1.183  1.25720   
28            29  2001 -1.736000 -1.891  0.812000 -0.218000 -0.865  1.11220   
29            30  2001 -1.851000 -1.736 -1.891000  0.012874 -0.218  1.20850    

'''
